<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2813. å­åºåˆ—æœ€å¤§ä¼˜é›…åº¦ - LeetCode</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-bar">
        <button class="menu-button" onclick="history.back()" aria-label="è¿”å›">
            <div class="menu-icon">
                <span style="transform: rotate(-45deg) translateY(-2px);"></span>
                <span style="transform: rotate(45deg) translateY(2px);"></span>
            </div>
        </button>
        <div class="logo">
            <span class="logo-emoji">ğŸ“š</span>
            LeetCode æ¯æ—¥é¢˜ç›®
        </div>
        <div class="update-time">2026-02-27 10:35:02</div>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content" style="margin-left: 0;">
        <div class="content-wrapper">
            <button class="back-button" onclick="history.back()">
                â† è¿”å›é¢˜ç›®åˆ—è¡¨
            </button>

            <div class="question-card">
                <div class="question-header">
                    <span class="question-number">2813. å­åºåˆ—æœ€å¤§ä¼˜é›…åº¦</span>
                    <span class="difficulty-badge difficulty-hard">
                        å›°éš¾
                    </span>
                    <a href="https://leetcode.cn/problems/maximum-elegance-of-a-k-length-subsequence/" target="_blank" class="question-link">åœ¨ LeetCode æ‰“å¼€</a>
                </div>
                <div class="markdown-content">
                    <h1 id="2813-å­åºåˆ—æœ€å¤§ä¼˜é›…åº¦">2813. å­åºåˆ—æœ€å¤§ä¼˜é›…åº¦</h1>

<p><strong>éš¾åº¦</strong>: Hard</p>

<p><strong>æ ‡ç­¾</strong>: æ ˆ, è´ªå¿ƒ, æ•°ç»„, å“ˆå¸Œè¡¨, æ’åº, å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰</p>

<p><strong>é“¾æ¥</strong>: https://leetcode.cn/problems/maximum-elegance-of-a-k-length-subsequence/</p>

<hr />

<h2 id="é¢˜ç›®æè¿°">é¢˜ç›®æè¿°</h2>

<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„äºŒç»´æ•´æ•°æ•°ç»„ <code>items</code> å’Œä¸€ä¸ªæ•´æ•° <code>k</code> ã€‚</p>

<p><code>items[i] = [profit<sub>i</sub>, category<sub>i</sub>]</code>ï¼Œå…¶ä¸­ <code>profit<sub>i</sub></code> å’Œ <code>category<sub>i</sub></code> åˆ†åˆ«è¡¨ç¤ºç¬¬ <code>i</code> ä¸ªé¡¹ç›®çš„åˆ©æ¶¦å’Œç±»åˆ«ã€‚</p>

<p>ç°å®šä¹‰&nbsp;<code>items</code> çš„ <strong>å­åºåˆ—</strong> çš„ <strong>ä¼˜é›…åº¦</strong> å¯ä»¥ç”¨ <code>total_profit + distinct_categories<sup>2</sup></code> è®¡ç®—ï¼Œå…¶ä¸­ <code>total_profit</code> æ˜¯å­åºåˆ—ä¸­æ‰€æœ‰é¡¹ç›®çš„åˆ©æ¶¦æ€»å’Œï¼Œ<code>distinct_categories</code> æ˜¯æ‰€é€‰å­åºåˆ—æ‰€å«çš„æ‰€æœ‰ç±»åˆ«ä¸­ä¸åŒç±»åˆ«çš„æ•°é‡ã€‚</p>

<p>ä½ çš„ä»»åŠ¡æ˜¯ä» <code>items</code> æ‰€æœ‰é•¿åº¦ä¸º <code>k</code> çš„å­åºåˆ—ä¸­ï¼Œæ‰¾å‡º <strong>æœ€å¤§ä¼˜é›…åº¦</strong> ã€‚</p>

<p>ç”¨æ•´æ•°å½¢å¼è¡¨ç¤ºå¹¶è¿”å› <code>items</code> ä¸­æ‰€æœ‰é•¿åº¦æ°å¥½ä¸º <code>k</code> çš„å­åºåˆ—çš„æœ€å¤§ä¼˜é›…åº¦ã€‚</p>

<p><strong>æ³¨æ„ï¼š</strong>æ•°ç»„çš„å­åºåˆ—æ˜¯ç»ç”±åŸæ•°ç»„åˆ é™¤ä¸€äº›å…ƒç´ ï¼ˆå¯èƒ½ä¸åˆ é™¤ï¼‰è€Œäº§ç”Ÿçš„æ–°æ•°ç»„ï¼Œä¸”åˆ é™¤ä¸æ”¹å˜å…¶ä½™å…ƒç´ ç›¸å¯¹é¡ºåºã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>items = [[3,2],[5,1],[10,1]], k = 2
<strong>è¾“å‡ºï¼š</strong>17
<strong>è§£é‡Šï¼š
</strong>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰å‡ºé•¿åº¦ä¸º 2 çš„å­åºåˆ—ã€‚
å…¶ä¸­ä¸€ç§æ–¹æ¡ˆæ˜¯ items[0] = [3,2] å’Œ items[2] = [10,1] ã€‚
å­åºåˆ—çš„æ€»åˆ©æ¶¦ä¸º 3 + 10 = 13 ï¼Œå­åºåˆ—åŒ…å« 2 ç§ä¸åŒç±»åˆ« [2,1] ã€‚
å› æ­¤ï¼Œä¼˜é›…åº¦ä¸º 13 + 2<sup>2</sup> = 17 ï¼Œå¯ä»¥è¯æ˜ 17 æ˜¯å¯ä»¥è·å¾—çš„æœ€å¤§ä¼˜é›…åº¦ã€‚ 
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>items = [[3,1],[3,1],[2,2],[5,3]], k = 3
<strong>è¾“å‡ºï¼š</strong>19
<strong>è§£é‡Šï¼š</strong>
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰å‡ºé•¿åº¦ä¸º 3 çš„å­åºåˆ—ã€‚ 
å…¶ä¸­ä¸€ç§æ–¹æ¡ˆæ˜¯ items[0] = [3,1] ï¼Œitems[2] = [2,2] å’Œ items[3] = [5,3] ã€‚
å­åºåˆ—çš„æ€»åˆ©æ¶¦ä¸º 3 + 2 + 5 = 10 ï¼Œå­åºåˆ—åŒ…å« 3 ç§ä¸åŒç±»åˆ« [1, 2, 3] ã€‚ 
å› æ­¤ï¼Œä¼˜é›…åº¦ä¸º 10 + 3<sup>2</sup> = 19 ï¼Œå¯ä»¥è¯æ˜ 19 æ˜¯å¯ä»¥è·å¾—çš„æœ€å¤§ä¼˜é›…åº¦ã€‚</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>items = [[1,1],[2,1],[3,1]], k = 3
<strong>è¾“å‡ºï¼š</strong>7
<strong>è§£é‡Šï¼š
</strong>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰å‡ºé•¿åº¦ä¸º 3 çš„å­åºåˆ—ã€‚
æˆ‘ä»¬éœ€è¦é€‰ä¸­æ‰€æœ‰é¡¹ç›®ã€‚
å­åºåˆ—çš„æ€»åˆ©æ¶¦ä¸º 1 + 2 + 3 = 6ï¼Œå­åºåˆ—åŒ…å« 1 ç§ä¸åŒç±»åˆ« [1] ã€‚
å› æ­¤ï¼Œæœ€å¤§ä¼˜é›…åº¦ä¸º 6 + 1<sup>2</sup> = 7 ã€‚</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
    <li><code>1 &lt;= items.length == n &lt;= 10<sup>5</sup></code></li>
    <li><code>items[i].length == 2</code></li>
    <li><code>items[i][0] == profit<sub>i</sub></code></li>
    <li><code>items[i][1] == category<sub>i</sub></code></li>
    <li><code>1 &lt;= profit<sub>i</sub> &lt;= 10<sup>9</sup></code></li>
    <li><code>1 &lt;= category<sub>i</sub> &lt;= n </code></li>
    <li><code>1 &lt;= k &lt;= n</code></li>
</ul>

<hr />

<h2 id="ä»£ç æ¨¡æ¿">ä»£ç æ¨¡æ¿</h2>

<h3 id="c">C++</h3>

<pre><code>class Solution {
public:
    long long findMaximumElegance(vector&lt;vector&lt;int&gt;&gt;&amp; items, int k) {

    }
};
</code></pre>

<h3 id="java">Java</h3>

<pre><code>class Solution {
    public long findMaximumElegance(int[][] items, int k) {

    }
}
</code></pre>

<h3 id="python3">Python3</h3>

<pre><code>class Solution:
    def findMaximumElegance(self, items: List[List[int]], k: int) -&gt; int:

</code></pre>

<h3 id="javascript">JavaScript</h3>

<pre><code>/**
 * @param {number[][]} items
 * @param {number} k
 * @return {number}
 */
var findMaximumElegance = function(items, k) {

};
</code></pre>

<h3 id="go">Go</h3>

<pre><code>func findMaximumElegance(items [][]int, k int) int64 {

}
</code></pre>

<hr />

<h2 id="æç¤º">æç¤º</h2>

<ol>
<li><div class="_1l1MA">Greedy algorithm.</div></li>
<li><div class="_1l1MA">Sort items in non-increasing order of profits.</div></li>
<li><div class="_1l1MA">Select the first <code>k</code> items (the top <code>k</code> most profitable items). Keep track of the items as the candidate set.</div></li>
<li><div class="_1l1MA">For the remaining <code>n - k</code> items sorted in non-increasing order of profits, try replacing an item in the candidate set using the current item.</div></li>
<li><div class="_1l1MA">The replacing item should add a new category to the candidate set and should remove the item with the minimum profit that occurs more than once in the candidate set.</div></li>
</ol>

<hr />

<h2 id="ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹">ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹</h2>

<pre><code>[[3,2],[5,1],[10,1]]
2
</code></pre>

<hr />

<h2 id="ai-è§£ç­”-deepseek">AI è§£ç­” (DeepSeek)</h2>

<h2 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h2>

<p>é¢˜ç›®è¦æ±‚ä» <code>items</code> ä¸­é€‰æ‹©æ°å¥½ <code>k</code> ä¸ªé¡¹ç›®ç»„æˆå­åºåˆ—ï¼Œä½¿å¾— <code>total_profit + distinct_categoriesÂ²</code> æœ€å¤§ã€‚å…¶ä¸­ï¼š
- <code>total_profit</code> æ˜¯æ‰€é€‰é¡¹ç›®çš„åˆ©æ¶¦æ€»å’Œ
- <code>distinct_categories</code> æ˜¯æ‰€é€‰é¡¹ç›®ä¸­ä¸åŒç±»åˆ«çš„æ•°é‡</p>

<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š
1. åˆ©æ¶¦æ€»å’Œè¶Šå¤§è¶Šå¥½ï¼Œä¸åŒç±»åˆ«æ•°é‡è¶Šå¤šè¶Šå¥½ï¼ˆå› ä¸ºå¹³æ–¹é¡¹å¢é•¿å¿«ï¼‰
2. ä½†é«˜åˆ©æ¶¦çš„é¡¹ç›®å¯èƒ½é›†ä¸­åœ¨å°‘æ•°ç±»åˆ«ä¸­
3. æˆ‘ä»¬éœ€è¦åœ¨åˆ©æ¶¦å’Œç±»åˆ«å¤šæ ·æ€§ä¹‹é—´æƒè¡¡</p>

<h2 id="è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯</h2>

<h3 id="æ ¸å¿ƒæ€è·¯">æ ¸å¿ƒæ€è·¯</h3>

<ol>
<li><strong>è´ªå¿ƒç­–ç•¥</strong>ï¼šå…ˆæŒ‰åˆ©æ¶¦é™åºæ’åºï¼Œé€‰å–å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„é¡¹ç›®</li>
<li><strong>é—®é¢˜</strong>ï¼šè¿™æ ·å¯èƒ½å¿½ç•¥ç±»åˆ«å¤šæ ·æ€§ï¼Œå¯¼è‡´å¹³æ–¹é¡¹è¾ƒå°</li>
<li><strong>ä¼˜åŒ–</strong>ï¼šç”¨æ ˆ/å †ç»´æŠ¤å·²é€‰é¡¹ç›®ï¼Œå°è¯•ç”¨æ–°ç±»åˆ«æ›¿æ¢é‡å¤ç±»åˆ«çš„ä½åˆ©æ¶¦é¡¹ç›®</li>
</ol>

<h3 id="è¯¦ç»†æ­¥éª¤">è¯¦ç»†æ­¥éª¤</h3>

<ol>
<li>å°† <code>items</code> æŒ‰åˆ©æ¶¦é™åºæ’åº</li>
<li>åˆå§‹åŒ–ï¼š
<ul>
<li>é€‰æ‹©å‰ k ä¸ªé¡¹ç›®</li>
<li>è®¡ç®—åˆå§‹åˆ©æ¶¦æ€»å’Œ</li>
<li>è®°å½•æ¯ä¸ªç±»åˆ«çš„å‡ºç°æ¬¡æ•°</li>
<li>ç”¨æ ˆä¿å­˜é‡å¤ç±»åˆ«çš„é¡¹ç›®ï¼ˆåˆ©æ¶¦ä½çš„åœ¨æ ˆé¡¶ï¼‰</li>
</ul></li>
<li>ä»ç¬¬ k+1 ä¸ªé¡¹ç›®å¼€å§‹éå†ï¼š
<ul>
<li>å¦‚æœå½“å‰é¡¹ç›®çš„ç±»åˆ«æ˜¯æ–°çš„ï¼ˆæœªå‡ºç°è¿‡ï¼‰</li>
<li>ä»æ ˆä¸­å¼¹å‡ºåˆ©æ¶¦æœ€ä½çš„é‡å¤ç±»åˆ«é¡¹ç›®</li>
<li>ç”¨å½“å‰é¡¹ç›®æ›¿æ¢å®ƒï¼Œæ›´æ–°åˆ©æ¶¦å’Œç±»åˆ«æ•°</li>
<li>è®¡ç®—æ–°çš„ä¼˜é›…åº¦ï¼Œæ›´æ–°æœ€å¤§å€¼</li>
</ul></li>
<li>æ³¨æ„ï¼šæ›¿æ¢çš„å‰ææ˜¯æ ˆä¸ä¸ºç©ºï¼ˆæœ‰é‡å¤ç±»åˆ«å¯æ›¿æ¢ï¼‰</li>
</ol>

<hr />

<h2 id="è§£æ³•ä¸€æ’åº-æ ˆ-è´ªå¿ƒ">è§£æ³•ä¸€ï¼šæ’åº + æ ˆ + è´ªå¿ƒ</h2>

<h3 id="æ€è·¯">æ€è·¯</h3>

<ol>
<li>æŒ‰åˆ©æ¶¦é™åºæ’åº</li>
<li>å…ˆé€‰å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„</li>
<li>ç”¨æ ˆä¿å­˜é‡å¤ç±»åˆ«çš„ä½åˆ©æ¶¦é¡¹ç›®</li>
<li>éå†å‰©ä½™é¡¹ç›®ï¼Œç”¨æ–°ç±»åˆ«æ›¿æ¢é‡å¤ç±»åˆ«çš„ä½åˆ©æ¶¦é¡¹ç›®</li>
</ol>

<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>

<h4 id="go-å®ç°">Go å®ç°</h4>

<pre><code>func findMaximumElegance(items [][]int, k int) int64 {
    // æŒ‰åˆ©æ¶¦é™åºæ’åº
    sort.Slice(items, func(i, j int) bool {
        return items[i][0] &gt; items[j][0]
    })

    totalProfit := int64(0)
    categoryMap := make(map[int]bool)
    duplicateStack := [][]int{} // æ ˆï¼Œå­˜å‚¨é‡å¤ç±»åˆ«çš„é¡¹ç›®

    // å…ˆé€‰å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„
    for i := 0; i &lt; k; i++ {
        profit, category := items[i][0], items[i][1]
        totalProfit += int64(profit)

        if categoryMap[category] {
            // é‡å¤ç±»åˆ«ï¼Œå…¥æ ˆ
            duplicateStack = append(duplicateStack, items[i])
        } else {
            categoryMap[category] = true
        }
    }

    distinct := len(categoryMap)
    maxElegance := totalProfit + int64(distinct)*int64(distinct)

    // å°è¯•ç”¨å‰©ä½™é¡¹ç›®æ›¿æ¢é‡å¤ç±»åˆ«çš„é¡¹ç›®
    for i := k; i &lt; len(items); i++ {
        profit, category := items[i][0], items[i][1]

        // å¦‚æœå½“å‰ç±»åˆ«æ˜¯æ–°çš„ï¼Œä¸”æ ˆä¸­æœ‰é‡å¤ç±»åˆ«çš„é¡¹ç›®å¯æ›¿æ¢
        if !categoryMap[category] &amp;&amp; len(duplicateStack) &gt; 0 {
            // å¼¹å‡ºæ ˆé¡¶ï¼ˆåˆ©æ¶¦æœ€ä½çš„é‡å¤ç±»åˆ«é¡¹ç›®ï¼‰
            popped := duplicateStack[len(duplicateStack)-1]
            duplicateStack = duplicateStack[:len(duplicateStack)-1]

            // æ›¿æ¢ï¼šå‡å»æ—§åˆ©æ¶¦ï¼ŒåŠ ä¸Šæ–°åˆ©æ¶¦
            totalProfit = totalProfit - int64(popped[0]) + int64(profit)
            // æ·»åŠ æ–°ç±»åˆ«
            categoryMap[category] = true
            distinct++

            // è®¡ç®—æ–°çš„ä¼˜é›…åº¦
            elegance := totalProfit + int64(distinct)*int64(distinct)
            if elegance &gt; maxElegance {
                maxElegance = elegance
            }
        }
    }

    return maxElegance
}
</code></pre>

<h4 id="c-å®ç°">C++ å®ç°</h4>

<pre><code>#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;unordered_map&gt;
#include &lt;stack&gt;
#include &lt;functional&gt;
using namespace std;

class Solution {
public:
    long long findMaximumElegance(vector&lt;vector&lt;int&gt;&gt;&amp; items, int k) {
        // æŒ‰åˆ©æ¶¦é™åºæ’åº
        sort(items.begin(), items.end(), [](const vector&lt;int&gt;&amp; a, const vector&lt;int&gt;&amp; b) {
            return a[0] &gt; b[0];
        });

        long long totalProfit = 0;
        unordered_map&lt;int, bool&gt; categoryMap;
        stack&lt;vector&lt;int&gt;&gt; duplicateStack; // å­˜å‚¨é‡å¤ç±»åˆ«çš„é¡¹ç›®

        // å…ˆé€‰å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„
        for (int i = 0; i &lt; k; i++) {
            int profit = items[i][0];
            int category = items[i][1];
            totalProfit += profit;

            if (categoryMap.find(category) != categoryMap.end()) {
                // é‡å¤ç±»åˆ«ï¼Œå…¥æ ˆ
                duplicateStack.push(items[i]);
            } else {
                categoryMap[category] = true;
            }
        }

        int distinct = categoryMap.size();
        long long maxElegance = totalProfit + (long long)distinct * distinct;

        // å°è¯•ç”¨å‰©ä½™é¡¹ç›®æ›¿æ¢é‡å¤ç±»åˆ«çš„é¡¹ç›®
        for (int i = k; i &lt; items.size(); i++) {
            int profit = items[i][0];
            int category = items[i][1];

            // å¦‚æœå½“å‰ç±»åˆ«æ˜¯æ–°çš„ï¼Œä¸”æ ˆä¸­æœ‰é‡å¤ç±»åˆ«çš„é¡¹ç›®å¯æ›¿æ¢
            if (categoryMap.find(category) == categoryMap.end() &amp;&amp; !duplicateStack.empty()) {
                // å¼¹å‡ºæ ˆé¡¶ï¼ˆåˆ©æ¶¦æœ€ä½çš„é‡å¤ç±»åˆ«é¡¹ç›®ï¼‰
                vector&lt;int&gt; popped = duplicateStack.top();
                duplicateStack.pop();

                // æ›¿æ¢ï¼šå‡å»æ—§åˆ©æ¶¦ï¼ŒåŠ ä¸Šæ–°åˆ©æ¶¦
                totalProfit = totalProfit - popped[0] + profit;
                // æ·»åŠ æ–°ç±»åˆ«
                categoryMap[category] = true;
                distinct++;

                // è®¡ç®—æ–°çš„ä¼˜é›…åº¦
                long long elegance = totalProfit + (long long)distinct * distinct;
                if (elegance &gt; maxElegance) {
                    maxElegance = elegance;
                }
            }
        }

        return maxElegance;
    }
};
</code></pre>

<h3 id="å¤æ‚åº¦åˆ†æ">å¤æ‚åº¦åˆ†æ</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n log n)ï¼Œä¸»è¦æ¥è‡ªæ’åº</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œç”¨äºå­˜å‚¨æ ˆå’Œå“ˆå¸Œè¡¨</li>
</ul>

<hr />

<h2 id="è§£æ³•äºŒæ’åº-æœ€å°å †ä¼˜åŒ–">è§£æ³•äºŒï¼šæ’åº + æœ€å°å †ä¼˜åŒ–</h2>

<h3 id="æ€è·¯-2">æ€è·¯</h3>

<p>ä¸è§£æ³•ä¸€ç±»ä¼¼ï¼Œä½†ä½¿ç”¨æœ€å°å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰æ¥ç»´æŠ¤é‡å¤ç±»åˆ«ä¸­çš„æœ€å°åˆ©æ¶¦é¡¹ç›®ï¼Œä¾¿äºå¿«é€Ÿè·å–æœ€å°å€¼ã€‚</p>

<h3 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h3>

<h4 id="go-å®ç°-2">Go å®ç°</h4>

<pre><code>import (
    "container/heap"
    "sort"
)

type MinHeap []int

func (h MinHeap) Len() int            { return len(h) }
func (h MinHeap) Less(i, j int) bool  { return h[i] &lt; h[j] }
func (h MinHeap) Swap(i, j int)       { h[i], h[j] = h[j], h[i] }
func (h *MinHeap) Push(x interface{}) { *h = append(*h, x.(int)) }
func (h *MinHeap) Pop() interface{} {
    old := *h
    n := len(old)
    x := old[n-1]
    *h = old[:n-1]
    return x
}

func findMaximumElegance(items [][]int, k int) int64 {
    // æŒ‰åˆ©æ¶¦é™åºæ’åº
    sort.Slice(items, func(i, j int) bool {
        return items[i][0] &gt; items[j][0]
    })

    totalProfit := int64(0)
    categoryMap := make(map[int]bool)
    duplicateHeap := &amp;MinHeap{} // æœ€å°å †ï¼Œå­˜å‚¨é‡å¤ç±»åˆ«çš„åˆ©æ¶¦
    heap.Init(duplicateHeap)

    // å…ˆé€‰å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„
    for i := 0; i &lt; k; i++ {
        profit, category := items[i][0], items[i][1]
        totalProfit += int64(profit)

        if categoryMap[category] {
            // é‡å¤ç±»åˆ«ï¼Œåˆ©æ¶¦åŠ å…¥æœ€å°å †
            heap.Push(duplicateHeap, profit)
        } else {
            categoryMap[category] = true
        }
    }

    distinct := len(categoryMap)
    maxElegance := totalProfit + int64(distinct)*int64(distinct)

    // å°è¯•ç”¨å‰©ä½™é¡¹ç›®æ›¿æ¢é‡å¤ç±»åˆ«çš„é¡¹ç›®
    for i := k; i &lt; len(items); i++ {
        profit, category := items[i][0], items[i][1]

        // å¦‚æœå½“å‰ç±»åˆ«æ˜¯æ–°çš„ï¼Œä¸”å †ä¸­æœ‰é‡å¤ç±»åˆ«çš„é¡¹ç›®å¯æ›¿æ¢
        if !categoryMap[category] &amp;&amp; duplicateHeap.Len() &gt; 0 {
            // å¼¹å‡ºæœ€å°åˆ©æ¶¦çš„é‡å¤ç±»åˆ«é¡¹ç›®
            minProfit := heap.Pop(duplicateHeap).(int)

            // æ›¿æ¢ï¼šå‡å»æ—§åˆ©æ¶¦ï¼ŒåŠ ä¸Šæ–°åˆ©æ¶¦
            totalProfit = totalProfit - int64(minProfit) + int64(profit)
            // æ·»åŠ æ–°ç±»åˆ«
            categoryMap[category] = true
            distinct++

            // è®¡ç®—æ–°çš„ä¼˜é›…åº¦
            elegance := totalProfit + int64(distinct)*int64(distinct)
            if elegance &gt; maxElegance {
                maxElegance = elegance
            }
        }
    }

    return maxElegance
}
</code></pre>

<h4 id="c-å®ç°-2">C++ å®ç°</h4>

<pre><code>#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;unordered_map&gt;
#include &lt;queue&gt;
using namespace std;

class Solution {
public:
    long long findMaximumElegance(vector&lt;vector&lt;int&gt;&gt;&amp; items, int k) {
        // æŒ‰åˆ©æ¶¦é™åºæ’åº
        sort(items.begin(), items.end(), [](const vector&lt;int&gt;&amp; a, const vector&lt;int&gt;&amp; b) {
            return a[0] &gt; b[0];
        });

        long long totalProfit = 0;
        unordered_map&lt;int, bool&gt; categoryMap;
        priority_queue&lt;int, vector&lt;int&gt;, greater&lt;int&gt;&gt; duplicateHeap; // æœ€å°å †

        // å…ˆé€‰å‰ k ä¸ªåˆ©æ¶¦æœ€é«˜çš„
        for (int i = 0; i &lt; k; i++) {
            int profit = items[i][0];
            int category = items[i][1];
            totalProfit += profit;

            if (categoryMap.find(category) != categoryMap.end()) {
                // é‡å¤ç±»åˆ«ï¼Œåˆ©æ¶¦åŠ å…¥æœ€å°å †
                duplicateHeap.push(profit);
            } else {
                categoryMap[category] = true;
            }
        }

        int distinct = categoryMap.size();
        long long maxElegance = totalProfit + (long long)distinct * distinct;

        // å°è¯•ç”¨å‰©ä½™é¡¹ç›®æ›¿æ¢é‡å¤ç±»åˆ«çš„é¡¹ç›®
        for (int i = k; i &lt; items.size(); i++) {
            int profit = items[i][0];
            int category = items[i][1];

            // å¦‚æœå½“å‰ç±»åˆ«æ˜¯æ–°çš„ï¼Œä¸”å †ä¸­æœ‰é‡å¤ç±»åˆ«çš„é¡¹ç›®å¯æ›¿æ¢
            if (categoryMap.find(category) == categoryMap.end() &amp;&amp; !duplicateHeap.empty()) {
                // å¼¹å‡ºæœ€å°åˆ©æ¶¦çš„é‡å¤ç±»åˆ«é¡¹ç›®
                int minProfit = duplicateHeap.top();
                duplicateHeap.pop();

                // æ›¿æ¢ï¼šå‡å»æ—§åˆ©æ¶¦ï¼ŒåŠ ä¸Šæ–°åˆ©æ¶¦
                totalProfit = totalProfit - minProfit + profit;
                // æ·»åŠ æ–°ç±»åˆ«
                categoryMap[category] = true;
                distinct++;

                // è®¡ç®—æ–°çš„ä¼˜é›…åº¦
                long long elegance = totalProfit + (long long)distinct * distinct;
                if (elegance &gt; maxElegance) {
                    maxElegance = elegance;
                }
            }
        }

        return maxElegance;
    }
};
</code></pre>

<h3 id="å¤æ‚åº¦åˆ†æ-2">å¤æ‚åº¦åˆ†æ</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n log n)ï¼Œæ’åº O(n log n)ï¼Œå †æ“ä½œ O(log k)</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œç”¨äºå­˜å‚¨å †å’Œå“ˆå¸Œè¡¨</li>
</ul>

<hr />

<h2 id="è§£æ³•ä¸‰åŠ¨æ€è§„åˆ’ä¸å¯è¡Œè¯´æ˜">è§£æ³•ä¸‰ï¼šåŠ¨æ€è§„åˆ’ï¼ˆä¸å¯è¡Œè¯´æ˜ï¼‰</h2>

<h3 id="ä¸ºä»€ä¹ˆåŠ¨æ€è§„åˆ’ä¸å¯è¡Œ">ä¸ºä»€ä¹ˆåŠ¨æ€è§„åˆ’ä¸å¯è¡Œï¼Ÿ</h3>

<ol>
<li>çŠ¶æ€ç©ºé—´å¤ªå¤§ï¼šéœ€è¦è®°å½•å·²é€‰é¡¹ç›®æ•°ã€åˆ©æ¶¦æ€»å’Œã€ç±»åˆ«é›†åˆ</li>
<li>ç±»åˆ«é›†åˆæ— æ³•å‹ç¼©ï¼šæœ€å¤šæœ‰ n ä¸ªä¸åŒç±»åˆ«ï¼Œéœ€è¦ 2^n çš„çŠ¶æ€</li>
<li>n æœ€å¤§ä¸º 10^5ï¼Œæ— æ³•ä½¿ç”¨çŠ¶å‹ DP</li>
<li>åˆ©æ¶¦å€¼èŒƒå›´å¤§ï¼ˆ1-10^9ï¼‰ï¼Œæ— æ³•ä½œä¸º DP ç»´åº¦</li>
</ol>

<p><strong>ç»“è®º</strong>ï¼šå¯¹äºæœ¬é¢˜çš„çº¦æŸæ¡ä»¶ï¼ŒåŠ¨æ€è§„åˆ’ä¸æ˜¯å¯è¡Œè§£æ³•ã€‚</p>

<hr />

<h2 id="è§£æ³•å¯¹æ¯”">è§£æ³•å¯¹æ¯”</h2>

<table>
<thead>
<tr>
  <th>ç‰¹æ€§</th>
  <th>è§£æ³•ä¸€ï¼ˆæ ˆï¼‰</th>
  <th>è§£æ³•äºŒï¼ˆæœ€å°å †ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
  <td>æ ¸å¿ƒæ•°æ®ç»“æ„</td>
  <td>æ ˆ</td>
  <td>æœ€å°å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰</td>
</tr>
<tr>
  <td>è·å–æœ€å°å€¼æ•ˆç‡</td>
  <td>O(1) å¼¹å‡ºæ ˆé¡¶</td>
  <td>O(log k) å¼¹å‡ºå †é¡¶</td>
</tr>
<tr>
  <td>ä»£ç å¤æ‚åº¦</td>
  <td>ç®€å•</td>
  <td>ç¨å¤æ‚ï¼ˆéœ€è¦å †å®ç°ï¼‰</td>
</tr>
<tr>
  <td>å®é™…æ€§èƒ½</td>
  <td>è¾ƒå¿«</td>
  <td>ç¨æ…¢ï¼ˆå †æ“ä½œæœ‰å¼€é”€ï¼‰</td>
</tr>
<tr>
  <td>é€‚ç”¨åœºæ™¯</td>
  <td>æ¨è</td>
  <td>å½“éœ€è¦é¢‘ç¹è·å–æœ€å°å€¼æ—¶</td>
</tr>
</tbody>
</table>

<h3 id="ä¼˜ç¼ºç‚¹åˆ†æ">ä¼˜ç¼ºç‚¹åˆ†æ</h3>

<p><strong>è§£æ³•ä¸€ï¼ˆæ ˆï¼‰çš„ä¼˜ç‚¹</strong>ï¼š
1. å®ç°ç®€å•ç›´è§‚
2. ç”±äºæ ˆé¡¶å°±æ˜¯æœ€å°åˆ©æ¶¦ï¼ˆå› ä¸ºæŒ‰åˆ©æ¶¦æ’åºåå…¥æ ˆï¼‰ï¼Œæ‰€ä»¥è·å–æœ€å°å€¼æ˜¯ O(1)
3. å®é™…è¿è¡Œæ•ˆç‡é«˜</p>

<p><strong>è§£æ³•äºŒï¼ˆæœ€å°å †ï¼‰çš„ä¼˜ç‚¹</strong>ï¼š
1. æ›´é€šç”¨çš„æ•°æ®ç»“æ„
2. å¦‚æœé—®é¢˜å˜ä½“éœ€è¦é¢‘ç¹è·å–æœ€å°å€¼ï¼Œå †æ›´åˆé€‚
3. é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£</p>

<p><strong>å…±åŒä¼˜ç‚¹</strong>ï¼š
1. æ—¶é—´å¤æ‚åº¦ O(n log n)ï¼Œå¯ä»¥å¤„ç† n=10^5
2. ç©ºé—´å¤æ‚åº¦ O(n)ï¼Œå¯ä»¥æ¥å—
3. åŸºäºè´ªå¿ƒç­–ç•¥ï¼Œæ­£ç¡®æ€§æœ‰ä¿éšœ</p>

<h3 id="æ¨èè§£æ³•">æ¨èè§£æ³•</h3>

<p>æ¨èä½¿ç”¨<strong>è§£æ³•ä¸€ï¼ˆæ ˆï¼‰</strong>ï¼Œå› ä¸ºï¼š
1. æœ¬é¢˜ä¸­æ ˆé¡¶è‡ªç„¶å°±æ˜¯æœ€å°åˆ©æ¶¦ï¼ˆæ’åºåå…¥æ ˆï¼‰
2. å®ç°æ›´ç®€å•
3. è¿è¡Œæ•ˆç‡æ›´é«˜</p>

<hr />

<h2 id="æ€»ç»“">æ€»ç»“</h2>

<p>æœ¬é¢˜çš„å…³é”®åœ¨äºç†è§£ï¼š
1. ä¼˜å…ˆé€‰æ‹©é«˜åˆ©æ¶¦é¡¹ç›®
2. ä½†ä¹Ÿè¦è€ƒè™‘ç±»åˆ«å¤šæ ·æ€§å¸¦æ¥çš„å¹³æ–¹æ”¶ç›Š
3. é€šè¿‡æ›¿æ¢é‡å¤ç±»åˆ«çš„ä½åˆ©æ¶¦é¡¹ç›®æ¥å¢åŠ ç±»åˆ«æ•°</p>

<p>è´ªå¿ƒç­–ç•¥ï¼ˆå…ˆé€‰åˆ©æ¶¦æœ€é«˜çš„ k ä¸ªï¼Œç„¶åå°è¯•æ›¿æ¢ï¼‰æ˜¯è§£å†³æœ¬é¢˜çš„æœ€ä¼˜æ–¹æ³•ï¼ŒåŠ¨æ€è§„åˆ’ç­‰å…¶å®ƒæ–¹æ³•åœ¨æœ¬é¢˜çº¦æŸä¸‹ä¸å¯è¡Œã€‚</p>

<hr />

<p><em>è·å–æ—¶é—´: 2026-02-27 10:35:02</em></p>

                </div>
            </div>

            <div class="footer">
                <p>ç”± <a href="https://github.com/LFrankl/leetcode" target="_blank">LeetCode Daily Script</a> è‡ªåŠ¨ç”Ÿæˆ</p>
                <p>AI è§£ç­”ç”± <a href="https://www.deepseek.com/" target="_blank">DeepSeek</a> æä¾›</p>
            </div>
        </div>
    </div>

    <!-- æµ®åŠ¨è¿”å›æŒ‰é’® -->
    <button class="fab-back" onclick="history.back()" aria-label="è¿”å›é¢˜ç›®åˆ—è¡¨">
        â†‘
    </button>
</body>
</html>