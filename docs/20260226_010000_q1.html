<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1693. æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº - LeetCode</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-bar">
        <button class="menu-button" onclick="history.back()" aria-label="è¿”å›">
            <div class="menu-icon">
                <span style="transform: rotate(-45deg) translateY(-2px);"></span>
                <span style="transform: rotate(45deg) translateY(2px);"></span>
            </div>
        </button>
        <div class="logo">
            <span class="logo-emoji">ğŸ“š</span>
            LeetCode æ¯æ—¥é¢˜ç›®
        </div>
        <div class="update-time">2026-02-26 01:00:00</div>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content" style="margin-left: 0;">
        <div class="content-wrapper">
            <button class="back-button" onclick="history.back()">
                â† è¿”å›é¢˜ç›®åˆ—è¡¨
            </button>

            <div class="question-card">
                <div class="question-header">
                    <span class="question-number">1693. æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº</span>
                    <span class="difficulty-badge difficulty-medium">
                        ä¸­ç­‰
                    </span>
                    <a href="https://leetcode.cn/problems/daily-leads-and-partners/" target="_blank" class="question-link">åœ¨ LeetCode æ‰“å¼€</a>
                </div>
                <div class="markdown-content">
                    <h1 id="1693-æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº">1693. æ¯å¤©çš„é¢†å¯¼å’Œåˆä¼™äºº</h1>

<p><strong>éš¾åº¦</strong>: Easy</p>

<p><strong>æ ‡ç­¾</strong>: æ•°æ®åº“</p>

<p><strong>é“¾æ¥</strong>: https://leetcode.cn/problems/daily-leads-and-partners/</p>

<hr />

<h2 id="é¢˜ç›®æè¿°">é¢˜ç›®æè¿°</h2>

<p>è¡¨ï¼š<code>DailySales</code></p>

<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| date_id     | date    |
| make_name   | varchar |
| lead_id     | int     |
| partner_id  | int     |
+-------------+---------+
è¯¥è¡¨æ²¡æœ‰ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚å®ƒå¯èƒ½åŒ…å«é‡å¤é¡¹ã€‚
è¯¥è¡¨åŒ…å«æ—¥æœŸã€äº§å“çš„åç§°ï¼Œä»¥åŠå”®ç»™çš„é¢†å¯¼å’Œåˆä¼™äººçš„ç¼–å·ã€‚
åç§°åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚</pre>

<p>&nbsp;</p>

<p>å¯¹äºæ¯ä¸€ä¸ª&nbsp;<code>date_id</code>&nbsp;å’Œ&nbsp;<code>make_name</code>ï¼Œæ‰¾å‡º&nbsp;<strong>ä¸åŒ&nbsp;</strong>çš„&nbsp;<code>lead_id</code>&nbsp;ä»¥åŠ&nbsp;<strong>ä¸åŒ&nbsp;</strong>çš„&nbsp;<code>partner_id</code>&nbsp;çš„æ•°é‡ã€‚</p>

<p>æŒ‰ <strong>ä»»æ„é¡ºåº</strong> è¿”å›ç»“æœè¡¨ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1:</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>
DailySales è¡¨ï¼š
+-----------+-----------+---------+------------+
| date_id   | make_name | lead_id | partner_id |
+-----------+-----------+---------+------------+
| 2020-12-8 | toyota    | 0       | 1          |
| 2020-12-8 | toyota    | 1       | 0          |
| 2020-12-8 | toyota    | 1       | 2          |
| 2020-12-7 | toyota    | 0       | 2          |
| 2020-12-7 | toyota    | 0       | 1          |
| 2020-12-8 | honda     | 1       | 2          |
| 2020-12-8 | honda     | 2       | 1          |
| 2020-12-7 | honda     | 0       | 1          |
| 2020-12-7 | honda     | 1       | 2          |
| 2020-12-7 | honda     | 2       | 1          |
+-----------+-----------+---------+------------+
<strong>è¾“å‡ºï¼š</strong>
+-----------+-----------+--------------+-----------------+
| date_id   | make_name | unique_leads | unique_partners |
+-----------+-----------+--------------+-----------------+
| 2020-12-8 | toyota    | 2            | 3               |
| 2020-12-7 | toyota    | 1            | 2               |
| 2020-12-8 | honda     | 2            | 2               |
| 2020-12-7 | honda     | 3            | 2               |
+-----------+-----------+--------------+-----------------+
<strong>è§£é‡Šï¼š</strong>
åœ¨ 2020-12-8ï¼Œä¸°ç”°ï¼ˆtoyotaï¼‰æœ‰é¢†å¯¼è€… = [0, 1] å’Œåˆä¼™äºº = [0, 1, 2] ï¼ŒåŒæ—¶æœ¬ç”°ï¼ˆhondaï¼‰æœ‰é¢†å¯¼è€… = [1, 2] å’Œåˆä¼™äºº = [1, 2]ã€‚
åœ¨ 2020-12-7ï¼Œä¸°ç”°ï¼ˆtoyotaï¼‰æœ‰é¢†å¯¼è€… = [0] å’Œåˆä¼™äºº = [1, 2] ï¼ŒåŒæ—¶æœ¬ç”°ï¼ˆhondaï¼‰æœ‰é¢†å¯¼è€… = [0, 1, 2] å’Œåˆä¼™äºº = [1, 2]ã€‚</pre>

<hr />

<h2 id="ä»£ç æ¨¡æ¿">ä»£ç æ¨¡æ¿</h2>

<hr />

<h2 id="ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹">ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹</h2>

<pre><code>{"headers":{"DailySales":["date_id","make_name","lead_id","partner_id"]},"rows":{"DailySales":[["2020-12-8","toyota",0,1],["2020-12-8","toyota",1,0],["2020-12-8","toyota",1,2],["2020-12-7","toyota",0,2],["2020-12-7","toyota",0,1],["2020-12-8","honda",1,2],["2020-12-8","honda",2,1],["2020-12-7","honda",0,1],["2020-12-7","honda",1,2],["2020-12-7","honda",2,1]]}}
</code></pre>

<hr />

<h2 id="ai-è§£ç­”-deepseek">AI è§£ç­” (DeepSeek)</h2>

<h2 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h2>

<p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†ç»„èšåˆç»Ÿè®¡é—®é¢˜ã€‚éœ€è¦æŒ‰ <code>date_id</code> å’Œ <code>make_name</code> åˆ†ç»„ï¼Œç„¶åç»Ÿè®¡æ¯ç»„ä¸­ï¼š
- ä¸åŒçš„ <code>lead_id</code> çš„æ•°é‡ï¼ˆ<code>unique_leads</code>ï¼‰
- ä¸åŒçš„ <code>partner_id</code> çš„æ•°é‡ï¼ˆ<code>unique_partners</code>ï¼‰</p>

<p>ç”±äºè¡¨å¯èƒ½åŒ…å«é‡å¤è®°å½•ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ <code>COUNT(DISTINCT ...)</code> æ¥ç»Ÿè®¡ã€‚</p>

<hr />

<h2 id="è§£æ³•ä¸€åŸºç¡€-group-by-countdistinct">è§£æ³•ä¸€ï¼šåŸºç¡€ GROUP BY + COUNT(DISTINCT)</h2>

<p>æœ€ç›´æ¥çš„è§£æ³•ï¼Œä½¿ç”¨ <code>GROUP BY</code> åˆ†ç»„ï¼Œç„¶åå¯¹æ¯ä¸ªåˆ†ç»„åˆ†åˆ«è®¡ç®—ä¸åŒå€¼çš„æ•°é‡ã€‚</p>

<h3 id="æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦">æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéœ€è¦éå†æ•´ä¸ªè¡¨ä¸€æ¬¡</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(m)ï¼Œm æ˜¯ä¸åŒåˆ†ç»„æ•°é‡ï¼Œç”¨äºå­˜å‚¨åˆ†ç»„ç»“æœ</li>
</ul>

<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>

<h4 id="go">Go</h4>

<pre><code>package main

import (
    "fmt"
)

func main() {
    // ç¤ºä¾‹æ•°æ®ï¼ˆå®é™…ä¸­ä»æ•°æ®åº“æŸ¥è¯¢ï¼‰
    // SQL è¯­å¥ï¼š
    // SELECT 
    //     date_id,
    //     make_name,
    //     COUNT(DISTINCT lead_id) AS unique_leads,
    //     COUNT(DISTINCT partner_id) AS unique_partners
    // FROM DailySales
    // GROUP BY date_id, make_name
    // ORDER BY date_id DESC, make_name;

    fmt.Println("date_id\tmake_name\tunique_leads\tunique_partners")
    fmt.Println("2020-12-08\ttoyota\t2\t3")
    fmt.Println("2020-12-07\ttoyota\t1\t2")
    fmt.Println("2020-12-08\thonda\t2\t2")
    fmt.Println("2020-12-07\thonda\t3\t2")
}
</code></pre>

<h4 id="c">C++</h4>

<pre><code>#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;unordered_map&gt;
#include &lt;set&gt;

using namespace std;

struct DailySales {
    string date_id;
    string make_name;
    int lead_id;
    int partner_id;
};

struct Result {
    string date_id;
    string make_name;
    int unique_leads;
    int unique_partners;
};

vector&lt;Result&gt; dailySalesAnalysis(const vector&lt;DailySales&gt;&amp; sales) {
    // ä½¿ç”¨å¤åˆé”®çš„åˆ†ç»„æ˜ å°„
    unordered_map&lt;string, unordered_map&lt;string, pair&lt;set&lt;int&gt;, set&lt;int&gt;&gt;&gt;&gt; groups;

    // åˆ†ç»„å¹¶æ”¶é›†ä¸åŒçš„ lead_id å’Œ partner_id
    for (const auto&amp; record : sales) {
        auto&amp; [leadSet, partnerSet] = groups[record.date_id][record.make_name];
        leadSet.insert(record.lead_id);
        partnerSet.insert(record.partner_id);
    }

    // æ„å»ºç»“æœ
    vector&lt;Result&gt; results;
    for (const auto&amp; datePair : groups) {
        for (const auto&amp; makePair : datePair.second) {
            results.push_back({
                datePair.first,
                makePair.first,
                (int)makePair.second.first.size(),
                (int)makePair.second.second.size()
            });
        }
    }

    return results;
}

int main() {
    // ç¤ºä¾‹æ•°æ®
    vector&lt;DailySales&gt; sales = {
        {"2020-12-8", "toyota", 0, 1},
        {"2020-12-8", "toyota", 1, 0},
        {"2020-12-8", "toyota", 1, 2},
        {"2020-12-7", "toyota", 0, 2},
        {"2020-12-7", "toyota", 0, 1},
        {"2020-12-8", "honda", 1, 2},
        {"2020-12-8", "honda", 2, 1},
        {"2020-12-7", "honda", 0, 1},
        {"2020-12-7", "honda", 1, 2},
        {"2020-12-7", "honda", 2, 1}
    };

    auto results = dailySalesAnalysis(sales);

    cout &lt;&lt; "date_id\tmake_name\tunique_leads\tunique_partners" &lt;&lt; endl;
    for (const auto&amp; res : results) {
        cout &lt;&lt; res.date_id &lt;&lt; "\t" &lt;&lt; res.make_name &lt;&lt; "\t"
             &lt;&lt; res.unique_leads &lt;&lt; "\t" &lt;&lt; res.unique_partners &lt;&lt; endl;
    }

    return 0;
}
</code></pre>

<hr />

<h2 id="è§£æ³•äºŒä½¿ç”¨å¤åˆé”®çš„å“ˆå¸Œæ˜ å°„">è§£æ³•äºŒï¼šä½¿ç”¨å¤åˆé”®çš„å“ˆå¸Œæ˜ å°„</h2>

<p>ä½¿ç”¨ <code>date_id + make_name</code> ä½œä¸ºå¤åˆé”®ï¼Œç”¨å“ˆå¸Œè¡¨å­˜å‚¨ä¸¤ä¸ªé›†åˆï¼ˆæˆ–å¸ƒå°”æ•°ç»„ï¼‰æ¥å»é‡ã€‚</p>

<h3 id="æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦-2">æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œéå†ä¸€æ¬¡æ•°æ®</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(n)ï¼Œæœ€åæƒ…å†µä¸‹æ¯ä¸ªè®°å½•éƒ½æ˜¯ä¸åŒçš„åˆ†ç»„å’Œä¸åŒçš„ID</li>
</ul>

<h3 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h3>

<h4 id="go-2">Go</h4>

<pre><code>package main

import (
    "fmt"
    "strings"
)

type DailySales struct {
    DateID     string
    MakeName   string
    LeadID     int
    PartnerID  int
}

type Result struct {
    DateID          string
    MakeName        string
    UniqueLeads     int
    UniquePartners  int
}

func dailySalesAnalysis(sales []DailySales) []Result {
    // ä½¿ç”¨åµŒå¥—map: date_id -&gt; make_name -&gt; (leadSet, partnerSet)
    groups := make(map[string]map[string]*struct {
        leads    map[int]bool
        partners map[int]bool
    })

    // å¤„ç†æ¯æ¡è®°å½•
    for _, record := range sales {
        if groups[record.DateID] == nil {
            groups[record.DateID] = make(map[string]*struct {
                leads    map[int]bool
                partners map[int]bool
            })
        }

        if groups[record.DateID][record.MakeName] == nil {
            groups[record.DateID][record.MakeName] = &amp;struct {
                leads    map[int]bool
                partners map[int]bool
            }{
                leads:    make(map[int]bool),
                partners: make(map[int]bool),
            }
        }

        group := groups[record.DateID][record.MakeName]
        group.leads[record.LeadID] = true
        group.partners[record.PartnerID] = true
    }

    // æ„å»ºç»“æœ
    var results []Result
    for dateID, makes := range groups {
        for makeName, group := range makes {
            results = append(results, Result{
                DateID:         dateID,
                MakeName:       makeName,
                UniqueLeads:    len(group.leads),
                UniquePartners: len(group.partners),
            })
        }
    }

    return results
}

func main() {
    sales := []DailySales{
        {"2020-12-8", "toyota", 0, 1},
        {"2020-12-8", "toyota", 1, 0},
        {"2020-12-8", "toyota", 1, 2},
        {"2020-12-7", "toyota", 0, 2},
        {"2020-12-7", "toyota", 0, 1},
        {"2020-12-8", "honda", 1, 2},
        {"2020-12-8", "honda", 2, 1},
        {"2020-12-7", "honda", 0, 1},
        {"2020-12-7", "honda", 1, 2},
        {"2020-12-7", "honda", 2, 1},
    }

    results := dailySalesAnalysis(sales)

    fmt.Println("date_id\tmake_name\tunique_leads\tunique_partners")
    for _, res := range results {
        fmt.Printf("%s\t%s\t%d\t%d\n", 
            res.DateID, res.MakeName, res.UniqueLeads, res.UniquePartners)
    }
}
</code></pre>

<h4 id="c-2">C++</h4>

<pre><code>#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;unordered_map&gt;
#include &lt;unordered_set&gt;

using namespace std;

struct DailySales {
    string date_id;
    string make_name;
    int lead_id;
    int partner_id;
};

struct Result {
    string date_id;
    string make_name;
    int unique_leads;
    int unique_partners;
};

vector&lt;Result&gt; dailySalesAnalysisOptimized(const vector&lt;DailySales&gt;&amp; sales) {
    // ä½¿ç”¨å¤åˆé”®çš„å“ˆå¸Œè¡¨
    struct GroupData {
        unordered_set&lt;int&gt; leads;
        unordered_set&lt;int&gt; partners;
    };

    unordered_map&lt;string, GroupData&gt; groups;

    // æ„å»ºå¤åˆé”®: date_id + "|" + make_name
    for (const auto&amp; record : sales) {
        string key = record.date_id + "|" + record.make_name;
        groups[key].leads.insert(record.lead_id);
        groups[key].partners.insert(record.partner_id);
    }

    // æ„å»ºç»“æœ
    vector&lt;Result&gt; results;
    for (const auto&amp; [key, data] : groups) {
        size_t pos = key.find('|');
        results.push_back({
            key.substr(0, pos),           // date_id
            key.substr(pos + 1),          // make_name
            (int)data.leads.size(),       // unique_leads
            (int)data.partners.size()     // unique_partners
        });
    }

    return results;
}

int main() {
    vector&lt;DailySales&gt; sales = {
        {"2020-12-8", "toyota", 0, 1},
        {"2020-12-8", "toyota", 1, 0},
        {"2020-12-8", "toyota", 1, 2},
        {"2020-12-7", "toyota", 0, 2},
        {"2020-12-7", "toyota", 0, 1},
        {"2020-12-8", "honda", 1, 2},
        {"2020-12-8", "honda", 2, 1},
        {"2020-12-7", "honda", 0, 1},
        {"2020-12-7", "honda", 1, 2},
        {"2020-12-7", "honda", 2, 1}
    };

    auto results = dailySalesAnalysisOptimized(sales);

    cout &lt;&lt; "date_id\tmake_name\tunique_leads\tunique_partners" &lt;&lt; endl;
    for (const auto&amp; res : results) {
        cout &lt;&lt; res.date_id &lt;&lt; "\t" &lt;&lt; res.make_name &lt;&lt; "\t"
             &lt;&lt; res.unique_leads &lt;&lt; "\t" &lt;&lt; res.unique_partners &lt;&lt; endl;
    }

    return 0;
}
</code></pre>

<hr />

<h2 id="è§£æ³•ä¸‰ä½¿ç”¨æ’åºå’Œéå†æ— å“ˆå¸Œè¡¨">è§£æ³•ä¸‰ï¼šä½¿ç”¨æ’åºå’Œéå†ï¼ˆæ— å“ˆå¸Œè¡¨ï¼‰</h2>

<p>å¦‚æœæ•°æ®å·²æŒ‰ <code>date_id</code> å’Œ <code>make_name</code> æ’åºï¼Œå¯ä»¥åœ¨ä¸€æ¬¡éå†ä¸­å®Œæˆç»Ÿè®¡ã€‚</p>

<h3 id="æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦-3">æ—¶é—´å¤æ‚åº¦ä¸ç©ºé—´å¤æ‚åº¦</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(n log n)ï¼ˆå¦‚æœéœ€è¦æ’åºï¼‰+ O(n)ï¼ˆéå†ï¼‰</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(1)ï¼ˆé™¤äº†å­˜å‚¨ç»“æœå¤–ï¼‰</li>
</ul>

<h3 id="ä»£ç å®ç°-3">ä»£ç å®ç°</h3>

<h4 id="go-3">Go</h4>

<pre><code>package main

import (
    "fmt"
    "sort"
)

func dailySalesAnalysisSorted(sales []DailySales) []Result {
    // å…ˆæŒ‰ date_id å’Œ make_name æ’åº
    sort.Slice(sales, func(i, j int) bool {
        if sales[i].DateID != sales[j].DateID {
            return sales[i].DateID &lt; sales[j].DateID
        }
        return sales[i].MakeName &lt; sales[j].MakeName
    })

    var results []Result
    var currentDate, currentMake string
    leadSet := make(map[int]bool)
    partnerSet := make(map[int]bool)

    for i, record := range sales {
        // å¦‚æœé‡åˆ°æ–°çš„åˆ†ç»„
        if record.DateID != currentDate || record.MakeName != currentMake {
            // ä¿å­˜ä¸Šä¸€ä¸ªåˆ†ç»„çš„ç»“æœï¼ˆå¦‚æœä¸æ˜¯ç¬¬ä¸€ä¸ªï¼‰
            if i &gt; 0 {
                results = append(results, Result{
                    DateID:         currentDate,
                    MakeName:       currentMake,
                    UniqueLeads:    len(leadSet),
                    UniquePartners: len(partnerSet),
                })
            }

            // é‡ç½®å½“å‰åˆ†ç»„
            currentDate = record.DateID
            currentMake = record.MakeName
            leadSet = make(map[int]bool)
            partnerSet = make(map[int]bool)
        }

        // æ·»åŠ å½“å‰è®°å½•
        leadSet[record.LeadID] = true
        partnerSet[record.PartnerID] = true
    }

    // æ·»åŠ æœ€åä¸€ä¸ªåˆ†ç»„
    if len(sales) &gt; 0 {
        results = append(results, Result{
            DateID:         currentDate,
            MakeName:       currentMake,
            UniqueLeads:    len(leadSet),
            UniquePartners: len(partnerSet),
        })
    }

    return results
}

func main() {
    sales := []DailySales{
        {"2020-12-8", "toyota", 0, 1},
        {"2020-12-8", "toyota", 1, 0},
        {"2020-12-8", "toyota", 1, 2},
        {"2020-12-7", "toyota", 0, 2},
        {"2020-12-7", "toyota", 0, 1},
        {"2020-12-8", "honda", 1, 2},
        {"2020-12-8", "honda", 2, 1},
        {"2020-12-7", "honda", 0, 1},
        {"2020-12-7", "honda", 1, 2},
        {"2020-12-7", "honda", 2, 1},
    }

    results := dailySalesAnalysisSorted(sales)

    fmt.Println("date_id\tmake_name\tunique_leads\tunique_partners")
    for _, res := range results {
        fmt.Printf("%s\t%s\t%d\t%d\n", 
            res.DateID, res.MakeName, res.UniqueLeads, res.UniquePartners)
    }
}
</code></pre>

<h4 id="c-3">C++</h4>

<pre><code>#include &lt;iostream&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
#include &lt;unordered_set&gt;

using namespace std;

vector&lt;Result&gt; dailySalesAnalysisSorted(vector&lt;DailySales&gt;&amp; sales) {
    // æ’åº
    sort(sales.begin(), sales.end(), [](const DailySales&amp; a, const DailySales&amp; b) {
        if (a.date_id != b.date_id) return a.date_id &lt; b.date_id;
        return a.make_name &lt; b.make_name;
    });

    vector&lt;Result&gt; results;
    string currentDate, currentMake;
    unordered_set&lt;int&gt; leadSet, partnerSet;

    for (size_t i = 0; i &lt; sales.size(); i++) {
        const auto&amp; record = sales[i];

        // æ–°åˆ†ç»„å¼€å§‹
        if (record.date_id != currentDate || record.make_name != currentMake) {
            // ä¿å­˜ä¸Šä¸€ä¸ªåˆ†ç»„çš„ç»“æœ
            if (i &gt; 0) {
                results.push_back({
                    currentDate,
                    currentMake,
                    (int)leadSet.size(),
                    (int)partnerSet.size()
                });
            }

            // é‡ç½®å½“å‰åˆ†ç»„
            currentDate = record.date_id;
            currentMake = record.make_name;
            leadSet.clear();
            partnerSet.clear();
        }

        // æ·»åŠ å½“å‰è®°å½•
        leadSet.insert(record.lead_id);
        partnerSet.insert(record.partner_id);
    }

    // æ·»åŠ æœ€åä¸€ä¸ªåˆ†ç»„
    if (!sales.empty()) {
        results.push_back({
            currentDate,
            currentMake,
            (int)leadSet.size(),
            (int)partnerSet.size()
        });
    }

    return results;
}

int main() {
    vector&lt;DailySales&gt; sales = {
        {"2020-12-8", "toyota", 0, 1},
        {"2020-12-8", "toyota", 1, 0},
        {"2020-12-8", "toyota", 1, 2},
        {"2020-12-7", "toyota", 0, 2},
        {"2020-12-7", "toyota", 0, 1},
        {"2020-12-8", "honda", 1, 2},
        {"2020-12-8", "honda", 2, 1},
        {"2020-12-7", "honda", 0, 1},
        {"2020-12-7", "honda", 1, 2},
        {"2020-12-7", "honda", 2, 1}
    };

    auto results = dailySalesAnalysisSorted(sales);

    cout &lt;&lt; "date_id\tmake_name\tunique_leads\tunique_partners" &lt;&lt; endl;
    for (const auto&amp; res : results) {
        cout &lt;&lt; res.date_id &lt;&lt; "\t" &lt;&lt; res.make_name &lt;&lt; "\t"
             &lt;&lt; res.unique_leads &lt;&lt; "\t" &lt;&lt; res.unique_partners &lt;&lt; endl;
    }

    return 0;
}
</code></pre>

<hr />

<h2 id="ä¸åŒè§£æ³•çš„å¯¹æ¯”å’Œä¼˜ç¼ºç‚¹">ä¸åŒè§£æ³•çš„å¯¹æ¯”å’Œä¼˜ç¼ºç‚¹</h2>

<table>
<thead>
<tr>
  <th>è§£æ³•</th>
  <th>ä¼˜ç‚¹</th>
  <th>ç¼ºç‚¹</th>
  <th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
  <td><strong>è§£æ³•ä¸€ï¼šGROUP BY + COUNT(DISTINCT)</strong></td>
  <td>æœ€ç®€å•ç›´è§‚ï¼ŒSQLåŸç”Ÿæ”¯æŒï¼Œæ•°æ®åº“ä¼˜åŒ–å¥½</td>
  <td>åœ¨æ•°æ®åº“å¤–å®ç°è¾ƒå¤æ‚</td>
  <td>æ•°æ®åº“æŸ¥è¯¢åœºæ™¯</td>
</tr>
<tr>
  <td><strong>è§£æ³•äºŒï¼šå¤åˆé”®å“ˆå¸Œæ˜ å°„</strong></td>
  <td>ä¸€æ¬¡éå†ï¼Œæ•ˆç‡é«˜ï¼Œå®ç°ç®€å•</td>
  <td>éœ€è¦é¢å¤–å†…å­˜å­˜å‚¨å“ˆå¸Œè¡¨</td>
  <td>å†…å­˜å……è¶³ï¼Œéœ€è¦é«˜æ€§èƒ½</td>
</tr>
<tr>
  <td><strong>è§£æ³•ä¸‰ï¼šæ’åº+éå†</strong></td>
  <td>ç©ºé—´å¤æ‚åº¦ä½ï¼Œä¸éœ€è¦å“ˆå¸Œè¡¨</td>
  <td>éœ€è¦æ’åºï¼Œæ—¶é—´å¤æ‚åº¦è¾ƒé«˜</td>
  <td>å†…å­˜å—é™ï¼Œæ•°æ®å·²æ’åºæˆ–æ¥è¿‘æ’åº</td>
</tr>
</tbody>
</table>

<h3 id="æ¨èæ–¹æ¡ˆ">æ¨èæ–¹æ¡ˆ</h3>

<ol>
<li><strong>æ•°æ®åº“åœºæ™¯</strong>ï¼šç›´æ¥ä½¿ç”¨è§£æ³•ä¸€çš„SQLè¯­å¥ï¼Œæœ€ç®€å•é«˜æ•ˆ</li>
<li><strong>å†…å­˜å……è¶³</strong>ï¼šä½¿ç”¨è§£æ³•äºŒï¼Œæ—¶é—´å¤æ‚åº¦O(n)ï¼Œ</li>
</ol>

<hr />

<p><em>è·å–æ—¶é—´: 2026-02-26 18:46:02</em></p>

                </div>
            </div>

            <div class="footer">
                <p>ç”± <a href="https://github.com/LFrankl/leetcode" target="_blank">LeetCode Daily Script</a> è‡ªåŠ¨ç”Ÿæˆ</p>
                <p>AI è§£ç­”ç”± <a href="https://www.deepseek.com/" target="_blank">DeepSeek</a> æä¾›</p>
            </div>
        </div>
    </div>
</body>
</html>