<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2019. è§£å‡ºæ•°å­¦è¡¨è¾¾å¼çš„å­¦ç”Ÿåˆ†æ•° - LeetCode</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-bar">
        <button class="menu-button" onclick="history.back()" aria-label="è¿”å›">
            <div class="menu-icon">
                <span style="transform: rotate(-45deg) translateY(-2px);"></span>
                <span style="transform: rotate(45deg) translateY(2px);"></span>
            </div>
        </button>
        <div class="logo">
            <span class="logo-emoji">ğŸ“š</span>
            LeetCode æ¯æ—¥é¢˜ç›®
        </div>
        <div class="update-time">2026-02-26 01:00:00</div>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content" style="margin-left: 0;">
        <div class="content-wrapper">
            <button class="back-button" onclick="history.back()">
                â† è¿”å›é¢˜ç›®åˆ—è¡¨
            </button>

            <div class="question-card">
                <div class="question-header">
                    <span class="question-number">2019. è§£å‡ºæ•°å­¦è¡¨è¾¾å¼çš„å­¦ç”Ÿåˆ†æ•°</span>
                    <span class="difficulty-badge difficulty-hard">
                        å›°éš¾
                    </span>
                    <a href="https://leetcode.cn/problems/the-score-of-students-solving-math-expression/" target="_blank" class="question-link">åœ¨ LeetCode æ‰“å¼€</a>
                </div>
                <div class="markdown-content">
                    <h1 id="2019-è§£å‡ºæ•°å­¦è¡¨è¾¾å¼çš„å­¦ç”Ÿåˆ†æ•°">2019. è§£å‡ºæ•°å­¦è¡¨è¾¾å¼çš„å­¦ç”Ÿåˆ†æ•°</h1>

<p><strong>éš¾åº¦</strong>: Hard</p>

<p><strong>æ ‡ç­¾</strong>: æ ˆ, è®°å¿†åŒ–, æ•°ç»„, å“ˆå¸Œè¡¨, æ•°å­¦, å­—ç¬¦ä¸², åŠ¨æ€è§„åˆ’</p>

<p><strong>é“¾æ¥</strong>: https://leetcode.cn/problems/the-score-of-students-solving-math-expression/</p>

<hr />

<h2 id="é¢˜ç›®æè¿°">é¢˜ç›®æè¿°</h2>

<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸²&nbsp;<code>s</code>&nbsp;ï¼Œå®ƒ <strong>åª</strong> åŒ…å«æ•°å­—&nbsp;<code>0-9</code>&nbsp;ï¼ŒåŠ æ³•è¿ç®—ç¬¦&nbsp;<code>'+'</code>&nbsp;å’Œä¹˜æ³•è¿ç®—ç¬¦&nbsp;<code>'*'</code>&nbsp;ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ª&nbsp;<strong>åˆæ³•</strong>&nbsp;çš„åªå«æœ‰&nbsp;<strong>ä¸ªä½æ•°</strong><strong>æ•°å­—</strong>&nbsp;çš„æ•°å­¦è¡¨è¾¾å¼ï¼ˆæ¯”æ–¹è¯´&nbsp;<code>3+5*2</code>ï¼‰ã€‚æœ‰ <code>n</code>&nbsp;ä½å°å­¦ç”Ÿå°†è®¡ç®—è¿™ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œå¹¶éµå¾ªå¦‚ä¸‹ <strong>è¿ç®—é¡ºåº</strong>&nbsp;ï¼š</p>

<ol>
    <li>æŒ‰ç…§ <strong>ä»å·¦åˆ°å³</strong>&nbsp;çš„é¡ºåºè®¡ç®— <strong>ä¹˜æ³•</strong>&nbsp;ï¼Œç„¶å</li>
    <li>æŒ‰ç…§ <strong>ä»å·¦åˆ°å³</strong>&nbsp;çš„é¡ºåºè®¡ç®— <strong>åŠ æ³•</strong>&nbsp;ã€‚</li>
</ol>

<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code>&nbsp;çš„æ•´æ•°æ•°ç»„&nbsp;<code>answers</code>&nbsp;ï¼Œè¡¨ç¤ºæ¯ä½å­¦ç”Ÿæäº¤çš„ç­”æ¡ˆã€‚ä½ çš„ä»»åŠ¡æ˜¯ç»™ <code>answer</code>&nbsp;æ•°ç»„æŒ‰ç…§å¦‚ä¸‹ <strong>è§„åˆ™</strong>&nbsp;æ‰“åˆ†ï¼š</p>

<ul>
    <li>å¦‚æœä¸€ä½å­¦ç”Ÿçš„ç­”æ¡ˆ <strong>ç­‰äº</strong>&nbsp;è¡¨è¾¾å¼çš„æ­£ç¡®ç»“æœï¼Œè¿™ä½å­¦ç”Ÿå°†å¾—åˆ° <code>5</code>&nbsp;åˆ†ã€‚</li>
    <li>å¦åˆ™ï¼Œå¦‚æœç­”æ¡ˆç”±&nbsp;<strong>ä¸€å¤„æˆ–å¤šå¤„é”™è¯¯çš„è¿ç®—é¡ºåº</strong>&nbsp;è®¡ç®—å¾—åˆ°ï¼Œé‚£ä¹ˆè¿™ä½å­¦ç”Ÿèƒ½å¾—åˆ° <code>2</code>&nbsp;åˆ†ã€‚</li>
    <li>å¦åˆ™ï¼Œè¿™ä½å­¦ç”Ÿå°†å¾—åˆ° <code>0</code>&nbsp;åˆ†ã€‚</li>
</ul>

<p>è¯·ä½ è¿”å›æ‰€æœ‰å­¦ç”Ÿçš„åˆ†æ•°å’Œã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<p><img alt="" src="https://assets.leetcode.com/uploads/2021/09/17/student_solving_math.png" style="width: 678px; height: 109px;" /></p>

<pre>
<b>è¾“å…¥ï¼š</b>s = "7+3*1*2", answers = [20,13,42]
<b>è¾“å‡ºï¼š</b>7
<b>è§£é‡Šï¼š</b>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæ­£ç¡®ç­”æ¡ˆä¸º 13 ï¼Œå› æ­¤æœ‰ä¸€ä½å­¦ç”Ÿå¾—åˆ†ä¸º 5 åˆ†ï¼š[20,<em><strong>13</strong></em>,42] ã€‚
ä¸€ä½å­¦ç”Ÿå¯èƒ½é€šè¿‡é”™è¯¯çš„è¿ç®—é¡ºåºå¾—åˆ°ç»“æœ 20 ï¼š7+3=10ï¼Œ10*1=10ï¼Œ10*2=20 ã€‚æ‰€ä»¥è¿™ä½å­¦ç”Ÿå¾—åˆ†ä¸º 2 åˆ†ï¼š[<em><strong>20</strong></em>,13,42] ã€‚
æ‰€æœ‰å­¦ç”Ÿå¾—åˆ†åˆ†åˆ«ä¸ºï¼š[2,5,0] ã€‚æ‰€æœ‰å¾—åˆ†ä¹‹å’Œä¸º 2+5+0=7 ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>s = "3+5*2", answers = [13,0,10,13,13,16,16]
<b>è¾“å‡ºï¼š</b>19
<b>è§£é‡Šï¼š</b>è¡¨è¾¾å¼çš„æ­£ç¡®ç»“æœä¸º 13 ï¼Œæ‰€ä»¥æœ‰ 3 ä½å­¦ç”Ÿå¾—åˆ° 5 åˆ†ï¼š[<em><strong>13</strong></em>,0,10,<em><strong>13</strong></em>,<em><strong>13</strong></em>,16,16] ã€‚
å­¦ç”Ÿå¯èƒ½é€šè¿‡é”™è¯¯çš„è¿ç®—é¡ºåºå¾—åˆ°ç»“æœ 16 ï¼š3+5=8ï¼Œ8*2=16 ã€‚æ‰€ä»¥ä¸¤ä½å­¦ç”Ÿå¾—åˆ° 2 åˆ†ï¼š[13,0,10,13,13,<em><strong>16</strong></em>,<em><strong>16</strong></em>] ã€‚
æ‰€æœ‰å­¦ç”Ÿå¾—åˆ†åˆ†åˆ«ä¸ºï¼š[5,0,0,5,5,2,2] ã€‚æ‰€æœ‰å¾—åˆ†ä¹‹å’Œä¸º 5+0+0+5+5+2+2=19 ã€‚
</pre>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>s = "6+0*1", answers = [12,9,6,4,8,6]
<b>è¾“å‡ºï¼š</b>10
<b>è§£é‡Šï¼š</b>è¡¨è¾¾å¼çš„æ­£ç¡®ç»“æœä¸º 6 ã€‚
å¦‚æœä¸€ä½å­¦ç”Ÿé€šè¿‡é”™è¯¯çš„è¿ç®—é¡ºåºè®¡ç®—è¯¥è¡¨è¾¾å¼ï¼Œç»“æœä»ä¸º 6 ã€‚
æ ¹æ®æ‰“åˆ†è§„åˆ™ï¼Œè¿ç®—é¡ºåºé”™è¯¯çš„å­¦ç”Ÿä¹Ÿå°†å¾—åˆ° 5 åˆ†ï¼ˆå› ä¸ºä»–ä»¬ä»ç„¶å¾—åˆ°äº†æ­£ç¡®çš„ç»“æœï¼‰ï¼Œè€Œä¸æ˜¯ 2 åˆ†ã€‚
æ‰€æœ‰å­¦ç”Ÿå¾—åˆ†åˆ†åˆ«ä¸ºï¼š[0,0,5,0,0,5] ã€‚æ‰€æœ‰å¾—åˆ†ä¹‹å’Œä¸º 10 åˆ†ã€‚
</pre>

<p>&nbsp;</p>

<p><strong>æç¤ºï¼š</strong></p>

<ul>
    <li><code>3 &lt;= s.length &lt;= 31</code></li>
    <li><code>s</code>&nbsp;è¡¨ç¤ºä¸€ä¸ªåªåŒ…å«&nbsp;<code>0-9</code>&nbsp;ï¼Œ<code>'+'</code>&nbsp;å’Œ&nbsp;<code>'*'</code>&nbsp;çš„åˆæ³•è¡¨è¾¾å¼ã€‚</li>
    <li>è¡¨è¾¾å¼ä¸­æ‰€æœ‰æ•´æ•°è¿ç®—æ•°å­—éƒ½åœ¨é—­åŒºé—´&nbsp;<code>[0, 9]</code>&nbsp;ä»¥å†…ã€‚</li>
    <li><code>1 &lt;=</code>&nbsp;æ•°å­¦è¡¨è¾¾å¼ä¸­æ‰€æœ‰è¿ç®—ç¬¦æ•°ç›®ï¼ˆ<code>'+'</code> å’Œ&nbsp;<code>'*'</code>ï¼‰&nbsp;<code>&lt;= 15</code></li>
    <li>æµ‹è¯•æ•°æ®ä¿è¯æ­£ç¡®è¡¨è¾¾å¼ç»“æœåœ¨èŒƒå›´&nbsp;<code>[0, 1000]</code>&nbsp;ä»¥å†…ã€‚</li>
    <li>æµ‹è¯•ç”¨ä¾‹ä¿è¯ä¹˜æ³•ä¸­é—´æ­¥éª¤ä¸­çš„å€¼æ°¸è¿œä¸ä¼šè¶…è¿‡ <code>10<sup>9</sup></code>ã€‚</li>
    <li><code>n == answers.length</code></li>
    <li><code>1 &lt;= n &lt;= 10<sup>4</sup></code></li>
    <li><code>0 &lt;= answers[i] &lt;= 1000</code></li>
</ul>

<hr />

<h2 id="ä»£ç æ¨¡æ¿">ä»£ç æ¨¡æ¿</h2>

<h3 id="c">C++</h3>

<pre><code>class Solution {
public:
    int scoreOfStudents(string s, vector&lt;int&gt;&amp; answers) {

    }
};
</code></pre>

<h3 id="java">Java</h3>

<pre><code>class Solution {
    public int scoreOfStudents(String s, int[] answers) {

    }
}
</code></pre>

<h3 id="python3">Python3</h3>

<pre><code>class Solution:
    def scoreOfStudents(self, s: str, answers: List[int]) -&gt; int:

</code></pre>

<h3 id="javascript">JavaScript</h3>

<pre><code>/**
 * @param {string} s
 * @param {number[]} answers
 * @return {number}
 */
var scoreOfStudents = function(s, answers) {

};
</code></pre>

<h3 id="go">Go</h3>

<pre><code>func scoreOfStudents(s string, answers []int) int {

}
</code></pre>

<hr />

<h2 id="æç¤º">æç¤º</h2>

<ol>
<li>The number of operators in the equation is less. Could you find the right answer then generate all possible answers using different orders of operations?</li>
<li>Divide the equation into blocks separated by the operators, and use memoization on the results of blocks for optimization.</li>
<li>Use set and the max limit of the answer for further optimization.</li>
</ol>

<hr />

<h2 id="ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹">ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹</h2>

<pre><code>"7+3*1*2"
[20,13,42]
</code></pre>

<hr />

<h2 id="ai-è§£ç­”-deepseek">AI è§£ç­” (DeepSeek)</h2>

<h2 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h2>

<p>è¿™æ˜¯ä¸€ä¸ªå…³äºæ•°å­¦è¡¨è¾¾å¼è®¡ç®—å’Œé”™è¯¯è¿ç®—é¡ºåºå¾—åˆ†çš„é¢˜ç›®ã€‚å…³é”®ç‚¹å¦‚ä¸‹ï¼š</p>

<ol>
<li><strong>åˆæ³•è¡¨è¾¾å¼</strong>ï¼šåªåŒ…å«æ•°å­— 0-9ã€'+' å’Œ '*'ï¼Œæ•°å­—éƒ½æ˜¯ä¸ªä½æ•°</li>
<li><strong>æ­£ç¡®è®¡ç®—é¡ºåº</strong>ï¼šå…ˆè®¡ç®—æ‰€æœ‰ä¹˜æ³•ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼Œå†è®¡ç®—æ‰€æœ‰åŠ æ³•ï¼ˆä»å·¦åˆ°å³ï¼‰</li>
<li><strong>å¾—åˆ†è§„åˆ™</strong>ï¼š
<ul>
<li>ç­”æ¡ˆç­‰äºæ­£ç¡®ç»“æœï¼š5åˆ†</li>
<li>ç­”æ¡ˆé€šè¿‡é”™è¯¯è¿ç®—é¡ºåºå¾—åˆ°ï¼ˆä½†ç»“æœæ­£ç¡®æ—¶ä»å¾—5åˆ†ï¼‰ï¼š2åˆ†</li>
<li>å…¶ä»–ï¼š0åˆ†</li>
</ul></li>
<li><strong>éœ€è¦è®¡ç®—</strong>ï¼šæ‰€æœ‰å­¦ç”Ÿå¾—åˆ†æ€»å’Œ</li>
</ol>

<p><strong>æ ¸å¿ƒæŒ‘æˆ˜</strong>ï¼šéœ€è¦æ‰¾å‡ºæ‰€æœ‰å¯èƒ½çš„è¿ç®—é¡ºåºï¼ˆåŒ…æ‹¬æ­£ç¡®å’Œé”™è¯¯çš„ï¼‰èƒ½äº§ç”Ÿçš„ç»“æœé›†åˆã€‚</p>

<h2 id="è§£é¢˜æ€è·¯">è§£é¢˜æ€è·¯</h2>

<h3 id="å…³é”®è§‚å¯Ÿ">å…³é”®è§‚å¯Ÿ</h3>

<ol>
<li>è¡¨è¾¾å¼ä¸­çš„æ•°å­—éƒ½æ˜¯ä¸ªä½æ•°ï¼ˆ0-9ï¼‰</li>
<li>è¿ç®—ç¬¦åªæœ‰ '+' å’Œ '*'</li>
<li>é”™è¯¯è¿ç®—é¡ºåºæ„å‘³ç€å¯ä»¥ä»»æ„é€‰æ‹©å…ˆè®¡ç®—å“ªä¸ªè¿ç®—ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼æŒ‰ç…§å…ˆä¹˜ååŠ </li>
<li>è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ª<strong>è¡¨è¾¾å¼æ‰€æœ‰å¯èƒ½æ±‚å€¼ç»“æœ</strong>çš„é—®é¢˜</li>
</ol>

<h3 id="é—®é¢˜è½¬åŒ–">é—®é¢˜è½¬åŒ–</h3>

<p>é¢˜ç›®ç­‰ä»·äºï¼šç»™å®šä¸€ä¸ªç”±æ•°å­—å’Œ '+'ã€'*' ç»„æˆçš„è¡¨è¾¾å¼ï¼Œæ±‚ï¼š
1. æŒ‰ç…§å…ˆä¹˜ååŠ è§„åˆ™çš„æ­£ç¡®ç»“æœ
2. æ‰€æœ‰å¯èƒ½çš„è¿ç®—é¡ºåºï¼ˆä»»æ„ç»“åˆé¡ºåºï¼‰èƒ½äº§ç”Ÿçš„ç»“æœé›†åˆ</p>

<p>ç„¶åå¯¹æ¯ä¸ªå­¦ç”Ÿçš„ç­”æ¡ˆï¼š
- å¦‚æœç­‰äºæ­£ç¡®ç»“æœï¼š5åˆ†
- å¦åˆ™å¦‚æœåœ¨æ‰€æœ‰å¯èƒ½ç»“æœé›†åˆä¸­ï¼š2åˆ†
- å¦åˆ™ï¼š0åˆ†</p>

<h2 id="è§£æ³•ä¸€åŒºé—´dpåŠ¨æ€è§„åˆ’">è§£æ³•ä¸€ï¼šåŒºé—´DPï¼ˆåŠ¨æ€è§„åˆ’ï¼‰</h2>

<h3 id="æ€è·¯">æ€è·¯</h3>

<p>ä½¿ç”¨åŠ¨æ€è§„åˆ’è®¡ç®—æ¯ä¸ªå­è¡¨è¾¾å¼çš„æ‰€æœ‰å¯èƒ½ç»“æœï¼š
- <code>dp[i][j]</code> è¡¨ç¤ºä»ç¬¬ i ä¸ªæ•°å­—åˆ°ç¬¬ j ä¸ªæ•°å­—ï¼ˆæŒ‰æ•°å­—ç´¢å¼•ï¼‰çš„æ‰€æœ‰å¯èƒ½ç»“æœé›†åˆ
- é€šè¿‡æšä¸¾åˆ†å‰²ç‚¹ kï¼Œå°†è¡¨è¾¾å¼åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç„¶åæ ¹æ®è¿ç®—ç¬¦ç»„åˆç»“æœ</p>

<h3 id="è¯¦ç»†æ­¥éª¤">è¯¦ç»†æ­¥éª¤</h3>

<ol>
<li>æå–æ‰€æœ‰æ•°å­—å’Œè¿ç®—ç¬¦</li>
<li>å®šä¹‰ <code>dp[i][j]</code> ä¸ºé›†åˆï¼Œå­˜å‚¨å­è¡¨è¾¾å¼ <code>nums[i..j]</code> çš„æ‰€æœ‰å¯èƒ½ç»“æœ</li>
<li>çŠ¶æ€è½¬ç§»ï¼š
<ul>
<li>å¦‚æœ i == jï¼š<code>dp[i][j] = {nums[i]}</code></li>
<li>å¦åˆ™ï¼šæšä¸¾åˆ†å‰²ç‚¹ k (i â‰¤ k &lt; j)
<ul>
<li>è¿ç®—ç¬¦ä¸º '+'ï¼š<code>dp[i][j] âˆª= {a+b | aâˆˆdp[i][k], bâˆˆdp[k+1][j]}</code></li>
<li>è¿ç®—ç¬¦ä¸º '*'ï¼š<code>dp[i][j] âˆª= {a*b | aâˆˆdp[i][k], bâˆˆdp[k+1][j]}</code></li>
</ul></li>
</ul></li>
<li>è®¡ç®—æ‰€æœ‰å¯èƒ½ç»“æœé›†åˆ</li>
<li>è®¡ç®—æ­£ç¡®ç»“æœï¼ˆå…ˆä¹˜ååŠ ï¼‰</li>
<li>æ ¹æ®è§„åˆ™è®¡ç®—å¾—åˆ†</li>
</ol>

<h3 id="ä»£ç å®ç°">ä»£ç å®ç°</h3>

<h4 id="go-å®ç°">Go å®ç°</h4>

<pre><code>func scoreOfStudents(s string, answers []int) int {
    n := len(s)
    // æå–æ•°å­—å’Œè¿ç®—ç¬¦
    nums := []int{}
    ops := []byte{}
    for i := 0; i &lt; n; i++ {
        if i%2 == 0 {
            nums = append(nums, int(s[i]-'0'))
        } else {
            ops = append(ops, s[i])
        }
    }

    m := len(nums)
    // dp[i][j] å­˜å‚¨æ‰€æœ‰å¯èƒ½ç»“æœ
    dp := make([][]map[int]bool, m)
    for i := range dp {
        dp[i] = make([]map[int]bool, m)
        for j := range dp[i] {
            dp[i][j] = make(map[int]bool)
        }
    }

    // åˆå§‹åŒ–ï¼šå•ä¸ªæ•°å­—
    for i := 0; i &lt; m; i++ {
        dp[i][i][nums[i]] = true
    }

    // åŒºé—´DP
    for length := 2; length &lt;= m; length++ {
        for i := 0; i+length-1 &lt; m; i++ {
            j := i + length - 1
            for k := i; k &lt; j; k++ {
                op := ops[k]
                for a := range dp[i][k] {
                    for b := range dp[k+1][j] {
                        if op == '+' {
                            sum := a + b
                            if sum &lt;= 1000 {
                                dp[i][j][sum] = true
                            }
                        } else { // '*'
                            prod := a * b
                            if prod &lt;= 1000 {
                                dp[i][j][prod] = true
                            }
                        }
                    }
                }
            }
        }
    }

    // æ‰€æœ‰å¯èƒ½ç»“æœ
    allResults := dp[0][m-1]

    // è®¡ç®—æ­£ç¡®ç»“æœï¼ˆå…ˆä¹˜ååŠ ï¼‰
    correctResult := calculateCorrect(s)

    // è®¡ç®—æ€»åˆ†
    totalScore := 0
    for _, ans := range answers {
        if ans == correctResult {
            totalScore += 5
        } else if allResults[ans] {
            totalScore += 2
        }
    }

    return totalScore
}

func calculateCorrect(s string) int {
    // å…ˆå¤„ç†ä¹˜æ³•
    nums := []int{}
    ops := []byte{}

    // ç¬¬ä¸€éï¼šå¤„ç†ä¹˜æ³•
    i := 0
    for i &lt; len(s) {
        if s[i] &gt;= '0' &amp;&amp; s[i] &lt;= '9' {
            num := int(s[i] - '0')
            // æŸ¥çœ‹åé¢æ˜¯å¦æ˜¯ä¹˜æ³•
            for i+1 &lt; len(s) &amp;&amp; s[i+1] == '*' {
                i += 2
                nextNum := int(s[i] - '0')
                num *= nextNum
            }
            nums = append(nums, num)
        } else if s[i] == '+' {
            ops = append(ops, '+')
        }
        i++
    }

    // ç¬¬äºŒéï¼šå¤„ç†åŠ æ³•
    result := nums[0]
    for j := 1; j &lt; len(nums); j++ {
        result += nums[j]
    }

    return result
}
</code></pre>

<h4 id="c-å®ç°">C++ å®ç°</h4>

<pre><code>class Solution {
public:
    int scoreOfStudents(string s, vector&lt;int&gt;&amp; answers) {
        int n = s.length();
        // æå–æ•°å­—å’Œè¿ç®—ç¬¦
        vector&lt;int&gt; nums;
        vector&lt;char&gt; ops;
        for (int i = 0; i &lt; n; i++) {
            if (i % 2 == 0) {
                nums.push_back(s[i] - '0');
            } else {
                ops.push_back(s[i]);
            }
        }

        int m = nums.size();
        // dp[i][j] å­˜å‚¨æ‰€æœ‰å¯èƒ½ç»“æœ
        vector&lt;vector&lt;unordered_set&lt;int&gt;&gt;&gt; dp(m, vector&lt;unordered_set&lt;int&gt;&gt;(m));

        // åˆå§‹åŒ–ï¼šå•ä¸ªæ•°å­—
        for (int i = 0; i &lt; m; i++) {
            dp[i][i].insert(nums[i]);
        }

        // åŒºé—´DP
        for (int len = 2; len &lt;= m; len++) {
            for (int i = 0; i + len - 1 &lt; m; i++) {
                int j = i + len - 1;
                for (int k = i; k &lt; j; k++) {
                    char op = ops[k];
                    for (int a : dp[i][k]) {
                        for (int b : dp[k+1][j]) {
                            if (op == '+') {
                                int sum = a + b;
                                if (sum &lt;= 1000) {
                                    dp[i][j].insert(sum);
                                }
                            } else { // '*'
                                int prod = a * b;
                                if (prod &lt;= 1000) {
                                    dp[i][j].insert(prod);
                                }
                            }
                        }
                    }
                }
            }
        }

        // æ‰€æœ‰å¯èƒ½ç»“æœ
        unordered_set&lt;int&gt; allResults = dp[0][m-1];

        // è®¡ç®—æ­£ç¡®ç»“æœ
        int correctResult = calculateCorrect(s);

        // è®¡ç®—æ€»åˆ†
        int totalScore = 0;
        for (int ans : answers) {
            if (ans == correctResult) {
                totalScore += 5;
            } else if (allResults.count(ans)) {
                totalScore += 2;
            }
        }

        return totalScore;
    }

private:
    int calculateCorrect(string s) {
        vector&lt;int&gt; nums;
        int i = 0;

        // ç¬¬ä¸€éï¼šå¤„ç†ä¹˜æ³•
        while (i &lt; s.length()) {
            if (isdigit(s[i])) {
                int num = s[i] - '0';
                // å¤„ç†è¿ç»­çš„ä¹˜æ³•
                while (i + 1 &lt; s.length() &amp;&amp; s[i+1] == '*') {
                    i += 2;
                    int nextNum = s[i] - '0';
                    num *= nextNum;
                }
                nums.push_back(num);
            }
            i++;
        }

        // ç¬¬äºŒéï¼šå¤„ç†åŠ æ³•
        int result = 0;
        for (int num : nums) {
            result += num;
        }

        return result;
    }
};
</code></pre>

<h3 id="å¤æ‚åº¦åˆ†æ">å¤æ‚åº¦åˆ†æ</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(mÂ³ Ã— RÂ²)ï¼Œå…¶ä¸­ m æ˜¯æ•°å­—ä¸ªæ•°ï¼ŒR æ˜¯å¯èƒ½ç»“æœçš„æ•°é‡ï¼ˆæœ€å¤§ 1000ï¼‰</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(mÂ² Ã— R)ï¼Œå­˜å‚¨ DP è¡¨</li>
</ul>

<h2 id="è§£æ³•äºŒè®°å¿†åŒ–æœç´¢-å‰ªæ">è§£æ³•äºŒï¼šè®°å¿†åŒ–æœç´¢ + å‰ªæ</h2>

<h3 id="æ€è·¯-2">æ€è·¯</h3>

<p>ä½¿ç”¨é€’å½’+è®°å¿†åŒ–æœç´¢ï¼Œé€šè¿‡å‰ªæå‡å°‘ä¸å¿…è¦çš„è®¡ç®—ï¼š
1. é€’å½’è®¡ç®—æ¯ä¸ªå­è¡¨è¾¾å¼çš„æ‰€æœ‰å¯èƒ½ç»“æœ
2. ä½¿ç”¨å¤‡å¿˜å½•é¿å…é‡å¤è®¡ç®—
3. å‰ªæï¼šè¶…è¿‡ 1000 çš„ç»“æœä¸å­˜å‚¨</p>

<h3 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h3>

<h4 id="go-å®ç°-2">Go å®ç°</h4>

<pre><code>func scoreOfStudents(s string, answers []int) int {
    n := len(s)
    // æå–æ•°å­—å’Œè¿ç®—ç¬¦
    nums := make([]int, (n+1)/2)
    ops := make([]byte, (n-1)/2)

    for i := 0; i &lt; n; i++ {
        if i%2 == 0 {
            nums[i/2] = int(s[i] - '0')
        } else {
            ops[i/2] = s[i]
        }
    }

    m := len(nums)
    memo := make([][]map[int]bool, m)
    for i := range memo {
        memo[i] = make([]map[int]bool, m)
    }

    // è®¡ç®—æ‰€æœ‰å¯èƒ½ç»“æœ
    allResults := dfs(nums, ops, 0, m-1, memo)

    // è®¡ç®—æ­£ç¡®ç»“æœ
    correctResult := calculateCorrect(s)

    // è®¡ç®—æ€»åˆ†
    totalScore := 0
    for _, ans := range answers {
        if ans == correctResult {
            totalScore += 5
        } else if allResults[ans] {
            totalScore += 2
        }
    }

    return totalScore
}

func dfs(nums []int, ops []byte, l, r int, memo [][]map[int]bool) map[int]bool {
    if memo[l][r] != nil {
        return memo[l][r]
    }

    result := make(map[int]bool)

    if l == r {
        result[nums[l]] = true
        memo[l][r] = result
        return result
    }

    for i := l; i &lt; r; i++ {
        leftResults := dfs(nums, ops, l, i, memo)
        rightResults := dfs(nums, ops, i+1, r, memo)

        op := ops[i]
        for a := range leftResults {
            for b := range rightResults {
                var val int
                if op == '+' {
                    val = a + b
                } else {
                    val = a * b
                }
                if val &lt;= 1000 {
                    result[val] = true
                }
            }
        }
    }

    memo[l][r] = result
    return result
}

// calculateCorrect å‡½æ•°åŒè§£æ³•ä¸€
</code></pre>

<h4 id="c-å®ç°-2">C++ å®ç°</h4>

<pre><code>class Solution {
public:
    int scoreOfStudents(string s, vector&lt;int&gt;&amp; answers) {
        int n = s.length();
        int m = (n + 1) / 2;
        vector&lt;int&gt; nums(m);
        vector&lt;char&gt; ops(m - 1);

        for (int i = 0; i &lt; n; i++) {
            if (i % 2 == 0) {
                nums[i / 2] = s[i] - '0';
            } else {
                ops[i / 2] = s[i];
            }
        }

        vector&lt;vector&lt;unordered_set&lt;int&gt;&gt;&gt; memo(m, vector&lt;unordered_set&lt;int&gt;&gt;(m));
        unordered_set&lt;int&gt; allResults = dfs(nums, ops, 0, m - 1, memo);

        int correctResult = calculateCorrect(s);

        int totalScore = 0;
        for (int ans : answers) {
            if (ans == correctResult) {
                totalScore += 5;
            } else if (allResults.count(ans)) {
                totalScore += 2;
            }
        }

        return totalScore;
    }

private:
    unordered_set&lt;int&gt; dfs(vector&lt;int&gt;&amp; nums, vector&lt;char&gt;&amp; ops, int l, int r, 
                          vector&lt;vector&lt;unordered_set&lt;int&gt;&gt;&gt;&amp; memo) {
        if (!memo[l][r].empty()) {
            return memo[l][r];
        }

        unordered_set&lt;int&gt; result;

        if (l == r) {
            result.insert(nums[l]);
            memo[l][r] = result;
            return result;
        }

        for (int i = l; i &lt; r; i++) {
            auto leftResults = dfs(nums, ops, l, i, memo);
            auto rightResults = dfs(nums, ops, i + 1, r, memo);

            char op = ops[i];
            for (int a : leftResults) {
                for (int b : rightResults) {
                    int val;
                    if (op == '+') {
                        val = a + b;
                    } else {
                        val = a * b;
                    }
                    if (val &lt;= 1000) {
                        result.insert(val);
                    }
                }
            }
        }

        memo[l][r] = result;
        return result;
    }

    // calculateCorrect å‡½æ•°åŒè§£æ³•ä¸€
};
</code></pre>

<h3 id="å¤æ‚åº¦åˆ†æ-2">å¤æ‚åº¦åˆ†æ</h3>

<ul>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>ï¼šO(mÂ³ Ã— RÂ²)ï¼Œä¸ DP ç›¸åŒï¼Œä½†å®é™…è¿è¡Œå¯èƒ½æ›´å¿«ï¼ˆå‰ªæï¼‰</li>
<li><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼šO(mÂ² Ã— R)</li>
</ul>

<h2 id="è§£æ³•ä¸‰ä¼˜åŒ–ç‰ˆdpæŒ‰è¿ç®—ç¬¦dp">è§£æ³•ä¸‰ï¼šä¼˜åŒ–ç‰ˆDPï¼ˆæŒ‰è¿ç®—ç¬¦DPï¼‰</h2>

<h3 id="æ€è·¯-3">æ€è·¯</h3>

<p>è§‚å¯Ÿåˆ°è¡¨è¾¾å¼æ˜¯æ•°å­—å’Œè¿ç®—ç¬¦äº¤æ›¿çš„ï¼Œå¯ä»¥æŒ‰è¿ç®—ç¬¦è¿›è¡ŒDPï¼š
1. <code>dp[i][j]</code> è¡¨ç¤ºä»ç¬¬ i ä¸ªè¿ç®—ç¬¦åˆ°ç¬¬ j ä¸ªè¿ç®—ç¬¦ä¹‹é—´çš„è¡¨è¾¾å¼æ‰€æœ‰å¯èƒ½ç»“æœ
2. å‡å°‘çŠ¶æ€æ•°é‡ï¼Œæé«˜æ•ˆç‡</p>

<h3 id="ä»£ç å®ç°-3">ä»£ç å®ç°</h3>

<h4 id="go-å®ç°-3">Go å®ç°</h4>

<pre><code>func scoreOfStudents(s string, answers []int) int {
    n := len(s)
    // æå–æ•°å­—
    nums := []int{}
    for i := 0; i &lt; n; i += 2 {
        nums = append(nums, int(s[i]-'0'))
    }

    m := len(nums)
    if m == 1 {
        // åªæœ‰ä¸€ä¸ªæ•°å­—
        correct := nums[0]
        total := 0
        for _, ans := range answers {
            if ans == correct {
                total += 5
            }
        }
        return total
    }

    // æå–è¿ç®—ç¬¦
    ops := []byte{}
    for i := 1; i &lt; n; i += 2 {
        ops = append(ops, s[i])
    }

    // dp[i][j] è¡¨ç¤º nums[i..j] çš„æ‰€æœ‰å¯èƒ½ç»“æœ
    dp := make([][]map[int]bool, m)
    for i := range dp {
        dp[i] = make([]map[int]bool, m)
        for j := range dp[i] {
            dp[i][j] = make(map[int]bool)
        }
    }

    // åˆå§‹åŒ–
    for i := 0; i &lt; m; i++ {
        dp[i][i][nums[i]] = true
    }

    // æŒ‰é•¿åº¦DP
    for length := 2; length &lt;= m; length++ {
        for i := 0; i+length-1 &lt; m; i++ {
            j := i + length - 1
            // æšä¸¾æœ€åä¸€ä¸ªè¿ç®—ç¬¦ä½ç½®
            for k := i; k &lt; j; k++ {
                leftSet := dp[i][k]
                rightSet := dp[k+1][j]
                op := ops[k]

                for a := range leftSet {
                    for b := range rightSet {
                        var val int
                        if op == '+' {
                            val = a + b
                        } else {
                            val = a * b
                        }
                        if val &lt;= 1000 {
                            dp[i][j][val] = true
                        }
                    }
                }
            }
        }
    }

    allResults := dp[0][m-1]
    correctResult := calculateCorrect(s)

    totalScore := 0
    for _, ans := range answers {
        if ans == correctResult {
            totalScore += 5
        } else if allResults[ans] {
            totalScore += 2
        }
    }

    return totalScore
}

// calculateCorrect å‡½æ•°åŒè§£æ³•ä¸€
</code></pre>

<h4 id="c-å®ç°-3">C++ å®ç°</h4>

<p>```cpp
class Solution {
public:
    int scoreOfStudents(string s, vector<int>&amp; answers) {
        int n = s.length();
        vector<int> nums;
        for (int i = 0; i &lt; n; i += 2) {
            nums.push_back(s[i] - '0');
        }</p>

<pre><code>    int m = nums.size();
    if (m == 1) {
        int correct = nums[0];
        int total = 0;
        for (int ans : answers) {
            if (ans == correct) total += 5;
        }
        return total;
    }

    vector&lt;char&gt; ops;
    for (int i = 1; i &lt; n; i += 2) {
        ops.push_back(s[i]);
    }

    vector&lt;vector&lt;unordered_set&lt;int&gt;&gt;&gt; dp(m, vector&lt;unordered_set&lt;int&gt;&gt;(m));

    // åˆå§‹åŒ–
    for (int i = 0; i &lt; m; i++) {
        dp[i][i].insert(nums[i]);
    }

    // DP
    for
</code></pre>

<hr />

<p><em>è·å–æ—¶é—´: 2026-02-26 18:48:40</em></p>

                </div>
            </div>

            <div class="footer">
                <p>ç”± <a href="https://github.com/LFrankl/leetcode" target="_blank">LeetCode Daily Script</a> è‡ªåŠ¨ç”Ÿæˆ</p>
                <p>AI è§£ç­”ç”± <a href="https://www.deepseek.com/" target="_blank">DeepSeek</a> æä¾›</p>
            </div>
        </div>
    </div>
</body>
</html>